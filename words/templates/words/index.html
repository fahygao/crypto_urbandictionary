{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <title>Crypto Buzzword Dictionary</title>
    <meta charset="utf-8" />
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet" />
    <link href="{% static 'css/pe-icon-7-stroke.css' %}" rel="stylesheet" />
    <link href="{% static 'css/rotating-card.css' %}" rel="stylesheet" />
    <link
      href="https://netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        background-color: #800080;
      }

      .header {
        background-color: #800080;
        padding: 20px;
        text-align: center;
      }

      .header h1 {
        color: #ffff00;
        margin: 0;
      }

      .nav {
        text-align: center;
        padding: 10px;
      }

      .nav a {
        color: #ffff00;
        text-decoration: none;
        margin: 0 10px;
      }

      .google-signin {
        background-color: #ffff00;
        padding: 20px;
        margin: 20px;
        text-align: center;
      }

      .buzzword-count {
        background-color: #ffff00;
        padding: 10px;
        margin: 20px;
        text-align: center;
      }

      .dotted-line {
        border-top: 3px dotted #ffff00;
        margin: 0;
      }

      .card-container {
        margin-bottom: 30px;
        height: 300px;
        perspective: 800px;
        position: relative;
      }

      .card {
        position: relative;
        background-color: #000080;
        height: 300px;
        border-radius: 10px;
        overflow: hidden;
        transform-style: preserve-3d;
        transition: transform 0.5s;
      }

      .front,
      .back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        cursor: pointer;
      }

      .front {
        z-index: 2;
        transform: rotateY(0deg);
      }

      .back {
        background-color: #000080;
        transform: rotateY(180deg);
      }

      .card-container.hover .card {
        transform: rotateY(180deg);
      }

      .back .content {
        padding: 15px;
        height: 300px;
        overflow-y: auto;
        color: white;
      }

      .stats-container {
        margin: 10px 0;
      }

      .voting {
        margin-top: 10px;
      }

      /* Make text more compact on the back */
      .back .text-center {
        margin: 5px 0;
      }

      .back h4 {
        color: #ffff00;
        margin: 10px 0;
      }

      .front .content {
        background-color: #000080;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 300px;
      }

      .front .main {
        text-align: center;
      }

      .front .name,
      .front .profession {
        color: white;
      }

      .name,
      .profession,
      .text-center {
        color: white !important;
      }

      .vote-button {
        background-color: #ffff00;
        border: none;
        padding: 10px 20px;
        margin: 0 10px;
        cursor: pointer;
      }

      .vote-count {
        display: inline-block;
        margin: 0 10px;
        color: white;
      }

      .definition-section,
      .example-section {
        margin-bottom: 15px;
      }

      .definition-text {
        font-size: 1.1em;
        line-height: 1.4;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Crypto Buzzword Dictionary</h1>
      <div class="nav">
        <a href="{% url 'index' %}">Home</a> |
        <a href="{% url 'about' %}">About</a> |
        <a href="#">Submit a Word</a>
      </div>
    </div>

    <div class="dotted-line"></div>

    <div class="google-signin">
      <img
        src="{% static 'images/google-icon.png' %}"
        alt="Google"
        style="vertical-align: middle; margin-right: 10px"
      />
      Sign in with Google
    </div>

    <div class="buzzword-count">{{ word_count }} Buzzwords Defined!</div>

    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          {% for word in words %}
          <div class="col-md-4 col-sm-6">
            <div class="card-container">
              <div class="card">
                <div class="front">
                  <div class="content" onclick="rotateCard(this)">
                    <div class="main">
                      <h3 class="name">{{ word.word }}</h3>
                    </div>
                  </div>
                </div>
                <div class="back">
                  <div class="content" onclick="rotateCard(this)">
                    <div class="main">
                      <div class="definition-section">
                        <h4 class="text-center">Definition</h4>
                        <p class="text-center definition-text">
                          {{ word.definition }}
                        </p>
                      </div>

                      {% if word.example %}
                      <div class="example-section">
                        <h4 class="text-center">Example</h4>
                        <p class="text-center">{{ word.example }}</p>
                      </div>
                      {% endif %}

                      <div class="stats-container">
                        <div class="stats">
                          <h4>{{ word.pub_date|date:"M d" }}</h4>
                          <p>Published</p>
                        </div>
                        <div class="stats">
                          <h4>{{ word.upvotes }}</h4>
                          <p>Upvotes</p>
                        </div>
                        <div class="stats">
                          <h4>{{ word.downvotes }}</h4>
                          <p>Downvotes</p>
                        </div>
                      </div>

                      <div class="voting">
                        <button
                          class="vote-button"
                          onclick="event.stopPropagation(); vote('{{ word.id }}', 'up')"
                        >
                          Upvote
                        </button>
                        <span class="vote-count">{{ word.upvotes }}</span>
                        <button
                          class="vote-button"
                          onclick="event.stopPropagation(); vote('{{ word.id }}', 'down')"
                        >
                          Downvote
                        </button>
                        <span class="vote-count">{{ word.downvotes }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <script src="{% static 'js/jquery-1.10.2.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script>
      function rotateCard(btn) {
        var $card = $(btn).closest(".card-container");
        if ($card.hasClass("hover")) {
          $card.removeClass("hover");
        } else {
          $card.addClass("hover");
        }
      }

      function vote(wordId, type) {
        // Add AJAX call to handle voting
        $.post("/vote/", {
          word_id: wordId,
          vote_type: type,
          csrfmiddlewaretoken: "{{ csrf_token }}",
        }).done(function (response) {
          // Update vote counts
          location.reload();
        });
      }
    </script>
  </body>
</html>
